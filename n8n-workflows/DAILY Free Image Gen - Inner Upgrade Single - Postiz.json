{
  "active": true,
  "connections": {
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet": {
      "main": [
        [
          {
            "node": "Parse Video Titles",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse Video Titles": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fallout-style prompt generator": {
      "main": [
        [
          {
            "node": "text to image",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Fallout-style prompt generator",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "AI Agent",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "OpenRouter Chat Model2": {
      "ai_languageModel": [
        [
          {
            "node": "Structured Output Parser",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Postiz": {
      "main": [
        [
          {
            "node": "Channel IDs - IUP",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Postiz1": {
      "main": [
        [
          {
            "node": "Aggregate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate": {
      "main": [
        [
          {
            "node": "Update row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Channel IDs - IUP": {
      "main": [
        [
          {
            "node": "Postiz1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "text to image": {
      "main": [
        [
          {
            "node": "Wait5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait5": {
      "main": [
        [
          {
            "node": "Postiz",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-09-12T12:27:04.472Z",
  "id": "Fn9OHyKxF0IJx5YI",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "DAILY Free Image Gen - Inner Upgrade Single - Postiz",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "triggerAtHour": 7
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -2176,
        96
      ],
      "id": "c42bbcd0-7906-4b01-abfb-e185dcf76f41",
      "name": "Schedule Trigger"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1XxHCK1eKmlbkB8G1fykneIQL6S15w-t6V0JKhOP_4Dc",
          "mode": "list",
          "cachedResultName": "INNER UPGRADE PHOTO TOPICS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XxHCK1eKmlbkB8G1fykneIQL6S15w-t6V0JKhOP_4Dc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1263742919,
          "mode": "list",
          "cachedResultName": "SIMPLIFIED SINGLE IMAGE",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XxHCK1eKmlbkB8G1fykneIQL6S15w-t6V0JKhOP_4Dc/edit#gid=1263742919"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        -1952,
        96
      ],
      "id": "f1ac4b81-4c4f-4d46-ac0c-5525d28a67dc",
      "name": "Get row(s) in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "G5F0HGiAwsbqZpbE",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Get all input items (each item is a row)\nconst inputItems = $input.all();\n\nif (!inputItems || inputItems.length === 0) {\n  return [{ json: { error: 'No rows returned from Google Sheets' } }];\n}\n\nconst availableTitles = [];\n\n// Each input item is a row object\nfor (let i = 0; i < inputItems.length; i++) {\n  const rowData = inputItems[i].json;\n  \n  const title = rowData.TITLE;\n  const photoPosted = rowData['PHOTO POSTED'];\n  \n  // Skip if no title or if it's a header\n  if (!title || title.toLowerCase() === 'title') continue;\n  \n  // Check if PHOTO POSTED is empty\n  if (title.trim().length > 0 && (!photoPosted || photoPosted.toString().trim() === '')) {\n    availableTitles.push({\n      title: title.trim(),\n      rowNumber: rowData.row_number,\n      date: rowData.DATE,\n      description: rowData.DESC\n    });\n  }\n}\n\nif (availableTitles.length === 0) {\n  return [{ json: { \n    error: 'No available titles found',\n    totalRows: inputItems.length,\n    sampleRow: inputItems[0].json\n  }}];\n}\n\n// Random selection\nconst randomIndex = Math.floor(Math.random() * availableTitles.length);\nconst randomSelection = availableTitles[randomIndex];\n\nconsole.log(`Selected \"${randomSelection.title}\" (${randomIndex + 1} of ${availableTitles.length} available)`);\n\nreturn [{\n  json: {\n    selectedTitle: randomSelection.title,\n    rowNumber: randomSelection.rowNumber,\n    availableCount: availableTitles.length,\n    selectedDate: randomSelection.date\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1728,
        96
      ],
      "id": "087897ef-1026-425c-900a-d7829764db83",
      "name": "Parse Video Titles"
    },
    {
      "parameters": {
        "jsCode": "// Get the agent's response\nconst inputData = $input.all()[0].json;\nconst agentData = inputData.output || inputData;\nconst originalTheme = agentData.originalTheme;\nconst context = agentData.context;\n\n// Check for necessary input\nif (!originalTheme || !context) {\n  return [{\n    json: {\n      error: 'Missing originalTheme or context from the upstream agent.',\n      receivedData: agentData\n    }\n  }];\n}\n\n// --- REVISED & MORE AGGRESSIVE STYLE DESCRIPTORS ---\nconst styleDescriptors = [\n  'ultrawide shot on gritty 35mm film, brutalist concrete gym, dramatic chiaroscuro lighting, heavy atmospheric dust, in the style of a Fallout game screenshot, desaturated, focus on environmental storytelling, no characters too close to the foreground',\n  'wide angle hyperrealistic render, vast post-apocalyptic setting, rusted weights scattered in the environment, volumetric god rays, stark and emotionless figure in the mid-distance',\n  'cinematic ultrawide photo, industrial grunge aesthetic, expansive weathered metal walls, cracked concrete stretching into the distance, single harsh light source illuminating the scene, figures in the background',\n  'dieselpunk art style, panoramic view of utilitarian machinery and desolate landscape, deeply desaturated muted tones, photorealistic texture, rendered in Unreal Engine 5, emphasis on the scale of the environment',\n  'raw, ultrawide cinematic photo, lone subject with an unflinching gaze, vast decaying industrial surroundings, high contrast black and white, emphasizing the environment\\'s scale, subject not in the immediate foreground'\n];\n\n// Pick a random style descriptor\nconst selectedStyle = styleDescriptors[Math.floor(Math.random() * styleDescriptors.length)];\n\n// Combine the AGENT'S context (the scene) with our technical style (the look)\nconst finalPrompt = `${context}, ${selectedStyle}, cinematic composition`;\n\nconsole.log(`Applied style \"${selectedStyle}\" to context for theme \"${originalTheme}\"`);\n\n// Return the final structured data\nreturn [{\n  json: {\n    prompt: finalPrompt,\n    motivationalTheme: originalTheme,\n    context: context, // The original, unmodified context\n    technicalStyle: selectedStyle, // The style we added\n    generatedAt: new Date().toISOString()\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1040,
        96
      ],
      "id": "09e0986b-8be2-4fcc-bb57-7a3fa00d57ad",
      "name": "Fallout-style prompt generator"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Given this motivational theme or topic: \"{{ $json.selectedTitle }}\", provide:\n\nA brief 2-3 sentence visual context that powerfully illustrates the theme by describing an environment without any people present.\n\nFocus on the setting, atmosphere, and any objects that strongly evoke the theme.\n\nThe scene should still feel stoic and resilient, reflecting the desired mood.\n\nDescribe the environment as if it were a still photograph of a place that embodies the motivational idea.\n\nAbsolutely no descriptions of people should be included in the context.\n\nDo NOT describe the artistic style (e.g., 'gritty', 'desaturated'). Just describe the content of the scene.\n\nA catchy social media title (50 characters or less).\n\nAn inspiring Instagram caption that educates on the theme or topic with relevant hashtags.\n\nReturn your response in this exact JSON format:\n{\n  \"originalTheme\": \"{{ $json.selectedTitle }}\",\n  \"context\": \"Your 2-3 sentence theme-relevant visual description of an environment without people.\",\n  \"socialTitle\": \"Catchy title about the motivational theme.\",\n  \"socialCaption\": \"Inspiring caption with emojis and hashtags.\"\n}",
        "hasOutputParser": true,
        "needsFallback": true,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.1,
      "position": [
        -1472,
        96
      ],
      "id": "3527063a-6a9f-42b2-af12-dfaeb74287ee",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": "meta-llama/llama-4-maverick:free",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        -1504,
        320
      ],
      "id": "f2957ad2-6246-43e4-a7da-c387f0e5c5c4",
      "name": "OpenRouter Chat Model",
      "credentials": {
        "openRouterApi": {
          "id": "Z0qdSGsCKeFZM9R5",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"originalTheme\": \"{{ $json.selectedTitle }}\",\n  \"context\": \"Your 2-3 sentence theme-relevant visual description of an environment without people.\",\n  \"socialTitle\": \"Catchy title about the motivational theme.\",\n  \"socialCaption\": \"Inspiring caption with emojis and hashtags.\"\n}",
        "autoFix": true
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        -1248,
        320
      ],
      "id": "e3694c15-90fc-42e6-87a9-befd477270da",
      "name": "Structured Output Parser"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1XxHCK1eKmlbkB8G1fykneIQL6S15w-t6V0JKhOP_4Dc",
          "mode": "list",
          "cachedResultName": "INNER UPGRADE PHOTO TOPICS",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XxHCK1eKmlbkB8G1fykneIQL6S15w-t6V0JKhOP_4Dc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1263742919,
          "mode": "list",
          "cachedResultName": "SIMPLIFIED SINGLE IMAGE",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1XxHCK1eKmlbkB8G1fykneIQL6S15w-t6V0JKhOP_4Dc/edit#gid=1263742919"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": "={{ $('Parse Video Titles').first().json.rowNumber }}",
            "PHOTO POSTED": "YES"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "TITLE",
              "displayName": "TITLE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PHOTO POSTED",
              "displayName": "PHOTO POSTED",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        528,
        96
      ],
      "id": "a32fd813-c334-4af1-87f3-384e4421c05d",
      "name": "Update row in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "G5F0HGiAwsbqZpbE",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "model": "meta-llama/llama-3.3-70b-instruct:free",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        -1376,
        320
      ],
      "id": "b6f92829-8f21-4689-813d-beb6e040f852",
      "name": "OpenRouter Chat Model1",
      "credentials": {
        "openRouterApi": {
          "id": "Z0qdSGsCKeFZM9R5",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "model": "meta-llama/llama-3.3-70b-instruct:free",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        -1168,
        528
      ],
      "id": "cb2d5a49-8278-4f4a-bdbd-eb80ed4a162c",
      "name": "OpenRouter Chat Model2",
      "credentials": {
        "openRouterApi": {
          "id": "Z0qdSGsCKeFZM9R5",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "operation": "uploadFile",
        "binaryProperty": "={{ $('text to image').item.binary }}"
      },
      "type": "n8n-nodes-postiz.postiz",
      "typeVersion": 1,
      "position": [
        -368,
        96
      ],
      "id": "08c1010d-c249-4869-a793-ddf37613f716",
      "name": "Postiz",
      "credentials": {
        "postizApi": {
          "id": "w48sNDeInJhYBUtQ",
          "name": "Postiz WTF Kreative"
        }
      }
    },
    {
      "parameters": {
        "date": "={{ $now }}",
        "posts": {
          "post": [
            {
              "integrationId": "={{ $json.Facebook }}",
              "value": {
                "contentItem": [
                  {
                    "content": "={{ $('AI Agent').item.json.output.socialCaption }}",
                    "image": {
                      "imageItem": [
                        {
                          "id": "={{ $('Postiz').item.json.id }}",
                          "path": "={{ $('Postiz').item.json.path }}"
                        }
                      ]
                    }
                  }
                ]
              }
            },
            {
              "integrationId": "={{ $json.Instagram }}",
              "settings": {
                "setting": [
                  {
                    "key": "post_type",
                    "stringValue": "post"
                  }
                ]
              },
              "value": {
                "contentItem": [
                  {
                    "content": "={{ $('AI Agent').item.json.output.socialCaption }}",
                    "image": {
                      "imageItem": [
                        {
                          "id": "={{ $('Postiz').item.json.id }}",
                          "path": "={{ $('Postiz').item.json.path }}"
                        }
                      ]
                    }
                  }
                ]
              }
            }
          ]
        }
      },
      "type": "n8n-nodes-postiz.postiz",
      "typeVersion": 1,
      "position": [
        80,
        96
      ],
      "id": "f6566d55-930b-4ea8-b1e3-c242f6236610",
      "name": "Postiz1",
      "credentials": {
        "postizApi": {
          "id": "w48sNDeInJhYBUtQ",
          "name": "Postiz WTF Kreative"
        }
      }
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        304,
        96
      ],
      "id": "ee554ed9-cbee-405c-8a25-2e993e8fcf10",
      "name": "Aggregate"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "88612fe5-9484-4237-986d-6230a62aa083",
              "name": "Facebook",
              "value": "cmffissqd0003rw7ft26fagu6",
              "type": "string"
            },
            {
              "id": "26eea580-acd3-4d0a-93d6-1052021ddd9f",
              "name": "Instagram",
              "value": "cmffixlzl0009rw7ff339t01y",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -144,
        96
      ],
      "id": "43003500-9ea2-4f15-b71f-32463415bbbb",
      "name": "Channel IDs - IUP"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://image.pollinations.ai/prompt/{{ $json.prompt }}?width=720&height=1280\n\n",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "nologo",
              "value": "true"
            },
            {
              "name": "private",
              "value": "true"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -816,
        96
      ],
      "id": "44f335bc-6b2a-4efe-b63e-81027ab59b81",
      "name": "text to image"
    },
    {
      "parameters": {
        "amount": 15
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -592,
        96
      ],
      "id": "167e900e-06bb-4f01-9ba3-ea46bd53fc6d",
      "name": "Wait5",
      "webhookId": "fc847c0d-2603-4348-bb6d-361b4ceee634"
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1",
    "timezone": "America/Chicago",
    "callerPolicy": "workflowsFromSameOwner",
    "errorWorkflow": "3DQkYrqphhTDeBq1"
  },
  "shared": [
    {
      "createdAt": "2025-09-12T12:27:04.472Z",
      "updatedAt": "2025-09-12T12:27:04.472Z",
      "role": "workflow:owner",
      "workflowId": "Fn9OHyKxF0IJx5YI",
      "projectId": "aYesZFcPjHzYQyLq"
    }
  ],
  "staticData": {
    "node:Schedule Trigger": {
      "recurrenceRules": []
    }
  },
  "tags": [
    {
      "createdAt": "2025-09-12T18:09:53.164Z",
      "updatedAt": "2025-09-12T18:09:53.164Z",
      "id": "E5uIgQAu9AEGW2wZ",
      "name": "IUP"
    },
    {
      "createdAt": "2025-09-12T17:38:42.049Z",
      "updatedAt": "2025-09-12T17:38:42.049Z",
      "id": "aGfv27TDHqLUsUfB",
      "name": "CURRENTLY IN USE"
    },
    {
      "createdAt": "2025-08-03T13:57:08.438Z",
      "updatedAt": "2025-08-03T13:57:08.438Z",
      "id": "Mas1jE28bXSMu19L",
      "name": "Fully Functional"
    }
  ],
  "triggerCount": 1,
  "updatedAt": "2025-10-02T17:48:14.198Z",
  "versionId": "4db8d859-8535-454f-9f7a-3d763349e86a"
}